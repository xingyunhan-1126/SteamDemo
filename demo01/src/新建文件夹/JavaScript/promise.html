<html>
    <script>
        //Promise构造函数接受一个函数作为参数
        //函数有两个参数分别是 resolve 和 reject 他们由JavaScript引擎部署，不用手动
        //promise实例有一个状态属性，执行resolve 会使状态由 pending(未完成)变为resolved，执行reject会使状态由pending变为rejected
        // var promise = new Promise( function(resolve, reject){
        //     //some code
        //     if(){
        //         resolve(value);
        //     }
        //     else{
        //         reject(error);
        //     }
        // });

        // //promise实例生成以后，可以用then方法分别指定resolved状态和rejected状态的回调函数
        // //then 接收两个函数作为参数（第二个为可选），第一个函数为resolved状态的回调函数，第二个函数为rejected状态的回调函数
        // promise.then(
        //     function(value){
        //         console.log(value);
        //     },
        //     function(error){
        //         console.log(error);

        //     }
        // )
        /*一个例子**/
        function timeOut(time){
            return new Promise(function(resolve,reject){
                return setTimeout(resolve,time,"done");     //time 之后的参数为 第一个函数参数的参数 （resolve的参数）
            })
        }
        timeOut(3000).then(function(value){console.log(value)});

        /*例子二 **/
        // Promise 新建后立即执行，所以首先输出的是Promise。然后，then方法指定的回调函数，将在当前脚本所有同步任务执行完才会执行，所以resolved最后输出。

        let promise = new Promise(function(resolve, reject) {
            console.log('Promise');        //1
            resolve();
        });

        promise.then(function() {
            console.log('resolved.');      //3
        });

        console.log('Hi!');                //2

        /*例子三  promise对象实现ajax**/
        var getJSON(url){
            let promise = new Promise(
                function(resolve,reject){
                    var xhr = new XMLHttpRequest;
                    xhr.open('GET',url,true);
                    xhr.send();
                    xhr.onreadystatechange = function(){
                        if(xhr.readyState == 4 && xhr.status == 200){
                            resolve(this.response);
                        }
                        else{
                            reject(this.statusText)
                        }
                    }
                }
            );
        }
        getJSON("/file/text.txt").then(function(json){
            console.log(json);
        },
        function(error){
            console.log(error);
        }
        );



    </script>
</html>